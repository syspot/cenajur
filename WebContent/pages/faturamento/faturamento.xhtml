<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">
	
	
  	<p:tabView id="tabview" dynamic="false">

		<p:tab id="tabFaturamento" title="Faturamento" >
		
		  	<h:form id="formFaturamento">
		  	
				<ui:param name="mbean" value="#{faturamentoFaces}" />
				<ui:param name="mbeanModel" value="#{faturamentoFaces.crudModel}" />
				<ui:param name="mbeanPesquisaModel" value="#{faturamentoFaces.crudPesquisaModel}" />
				
				<div align="right" style="width: 97.5%">
					<p:commandButton value="Adicionar Manual" onclick="dlgFaturamento.show();" icon="novo" style="width: 150px; margin-left: 5px;">
			  			<f:setPropertyActionListener target="#{mbean.inserindo}" value="#{true}" />
			  		</p:commandButton>
				</div>
		  	
		  		<h:panelGrid style="width:50%">
		  		
		  			<h:outputText value="Cliente" />
					<p:outputPanel autoUpdate="true">
						<p:inputText value="#{mbeanPesquisaModel.cliente.nome}" readonly="true" styleClass="coluna80" rendered="#{not empty mbeanPesquisaModel.cliente}"/>
						<p:inputText readonly="true" styleClass="coluna80" rendered="#{empty mbeanPesquisaModel.cliente}"/>
						<p:commandButton type="button" value="Add" icon="ui-icon-plus" onclick="dlgCliente3.show()" rendered="#{empty mbeanPesquisaModel.cliente}"/>
						<p:commandButton value="Remover" action="#{mbean.removerCliente}" rendered="#{not empty mbeanPesquisaModel.cliente}"/>
					</p:outputPanel>
				
				</h:panelGrid>
				
				<h:panelGrid columns="3" columnClasses="coluna30, coluna30, coluna30" style="width:30%">
				
			  		<p:outputLabel for="planoPesquisa" value="Plano" />
				  	<p:outputLabel for="mesPesquisa" value="Mês" />
				  	<p:outputLabel for="anoPesquisa" value="Ano" />
				  	
			  		<p:selectOneMenu id="planoPesquisa" value="#{mbeanPesquisaModel.plano.id}" >
				  		<f:selectItem itemLabel="Não Selecionado" itemValue="" />
				  		<f:selectItems value="#{mbean.planos}" />
				  	</p:selectOneMenu>
				  	
				  	<p:selectOneMenu id="mesPesquisa" value="#{mbeanPesquisaModel.mes}" >
				  		<f:selectItem itemLabel="Não Selecionado" itemValue="" />
				  		<f:selectItem itemLabel="01" itemValue="#{1}" />
				  		<f:selectItem itemLabel="02" itemValue="#{2}" />
				  		<f:selectItem itemLabel="03" itemValue="#{3}" />
				  		<f:selectItem itemLabel="04" itemValue="#{4}" />
				  		<f:selectItem itemLabel="05" itemValue="#{5}" />
				  		<f:selectItem itemLabel="06" itemValue="#{6}" />
				  		<f:selectItem itemLabel="07" itemValue="#{7}" />
				  		<f:selectItem itemLabel="08" itemValue="#{8}" />
				  		<f:selectItem itemLabel="09" itemValue="#{9}" />
				  		<f:selectItem itemLabel="10" itemValue="#{10}" />
				  		<f:selectItem itemLabel="11" itemValue="#{11}" />
				  		<f:selectItem itemLabel="12" itemValue="#{12}" />
				  	</p:selectOneMenu>
				  	
			  		<p:selectOneMenu id="anoPesquisa" value="#{mbeanPesquisaModel.ano}" >
				  		<f:selectItem itemLabel="Não Selecionado" itemValue="" />
				  		<f:selectItem itemLabel="2011" itemValue="#{2011}" />
				  		<f:selectItem itemLabel="2012" itemValue="#{2012}" />
				  		<f:selectItem itemLabel="2013" itemValue="#{2013}" />
				  		<f:selectItem itemLabel="2014" itemValue="#{2014}" />
				  	</p:selectOneMenu>
				  	
		  		</h:panelGrid>
		  		
		  		<h:panelGrid columns="2" columnClasses="coluna50, coluna50" style="width:10%">
		  		
		  			<p:outputLabel for="flagPagoPesquisa" value="Pago" />
				  	<p:outputLabel for="flagCanceladoPesquisa" value="Cancelado" />
		  		
				  	<p:selectBooleanCheckbox id="flagPagoPesquisa" value="#{mbeanPesquisaModel.flagPago}" />
				  	<p:selectBooleanCheckbox id="flagCanceladoPesquisa" value="#{mbeanPesquisaModel.flagCancelado}" />
				  	
			  	</h:panelGrid>
			  	
		  		<p:commandButton value="Pesquisar" action="#{mbean.findEvent}" update="dtFaturamento" style="margin-top: 10px"/>
		  	
		  		<p:remoteCommand name="alterarFaturamento" action="#{mbean.updateEvent}" global="false" />
		  		
		  		<p:dataTable id="dtFaturamento" emptyMessage="Nenhum registro encontrado" rows="20" 
		  			var="faturamento" value="#{mbean.grid}" style="width:100%; margin-top: 30px">
		  		
		  			<p:column headerText="Id">
		  				<h:outputText value="#{faturamento.id}"></h:outputText>
		  			</p:column>
		  			
		  			<p:column headerText="Nome do Cliente">
		  				<h:outputText value="#{faturamento.cliente.nome}"></h:outputText>
		  			</p:column>
		  			
		  			<p:column headerText="Plano">
		  				<h:outputText value="#{faturamento.plano.descricao}"></h:outputText>
		  			</p:column>
		  			
		  			<p:column headerText="Valor">
		  				<h:outputText value="#{faturamento.valor}"></h:outputText>
		  			</p:column>
		  			
		  			<p:column headerText="Cancelar" styleClass="coluna10" style="text-align: center">
		  				<h:outputText value="Cancelado" rendered="#{faturamento.flagCancelado}" styleClass="cancelado" />		  			
		  				<p:commandLink action="#{mbean.updateEvent}" title="Cancelar" rendered="#{!faturamento.flagCancelado}">
							<h:graphicImage value="../resources/images/hide.png" style="border: 0px" />	                     
							<f:setPropertyActionListener target="#{mbean.crudModel}" value="#{faturamento}" />
							<f:setPropertyActionListener target="#{mbean.crudModel.flagCancelado}" value="#{true}" />
	  						<f:setPropertyActionListener target="#{mbean.inserindo}" value="#{false}" />
						</p:commandLink>
		  			</p:column>
		  			
		  			<p:column headerText="Pagar" styleClass="coluna10" style="text-align: center">
						<h:outputText value="Pago" rendered="#{faturamento.flagPago}" styleClass="pago" />		  			
		  				<p:commandLink action="#{mbean.updateEvent}" title="Pagar" rendered="#{!faturamento.flagPago and !faturamento.flagCancelado}">
							<h:graphicImage value="../resources/images/passed.png" style="border: 0px" />	                     
							<f:setPropertyActionListener target="#{mbean.crudModel}" value="#{faturamento}" />
							<f:setPropertyActionListener target="#{mbean.crudModel.flagPago}" value="#{true}" />
	  						<f:setPropertyActionListener target="#{mbean.inserindo}" value="#{false}" />
						</p:commandLink>
		  			</p:column>
		  		
		  		</p:dataTable>
		  		
			</h:form>
			
		</p:tab>
		
	</p:tabView>
  	
</ui:composition>