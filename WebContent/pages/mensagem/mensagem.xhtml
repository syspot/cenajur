<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">
	
  	<p:tabView id="tabview" dynamic="false">

		<p:tab id="tabAgenda" title="Agenda" >
		
			<ui:include src="/pages/mensagem/agenda.xhtml" />
			
		</p:tab>
		
		<p:tab id="tabMensagem" title="Mensagem" >
		
		  	<h:form id="formMensagem">
		  	
		  		<p:commandButton type="button" value="Nova Mensagem" onclick="dlgMensagem.show();"/>
		  
		  		<p:remoteCommand name="abrirModelMensagem" oncomplete="mensagemDialog.show();" update="pgMensagem" process="@this" />
		  		
			    <p:dataGrid var="mensagem" value="#{mensagemFaces.mensagens}" columns="3"  
			        rows="12" paginator="true"  paginatorAlwaysVisible="false"
			        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
			        rowsPerPageTemplate="9,12,15">  
			          
			        <p:column>  
			            <p:panel>  
			                <h:panelGrid columns="2" columnClasses="coluna25_2, coluna75_2" style="width:100%; vertical-align: top">
			                    
			                    <h:outputText value="Data:" />  
			                    <h:outputText value="#{mensagem.data}" />
			                      
			                    <h:outputText value="Remetente:" />  
			                    <h:outputText value="#{mensagem.remetente.nome}" />
			                      
			                    <h:outputText value="Mensagem:" />
			                    <h:panelGrid columns="2">
			                    	<h:outputText value="#{mensagem.textoResumo}" style="text-align: lef;"/>
			                    	<p:commandLink type="button" oncomplete="abrirModelMensagem();" process="@this" global="false" value="Leia Mais" style="text-align: lef; color: #228B22" rendered="#{mensagem.texto.length() > 20}">
			                    		<f:setPropertyActionListener target="#{mensagemFaces.mensagemSelecionada}" value="#{mensagem}"/>
			                    	</p:commandLink>
			                    </h:panelGrid>
			                      
			                </h:panelGrid>  
			            </p:panel>  
			        </p:column>  
			  
			    </p:dataGrid>  
			      
			    <p:dialog header="Detalhe da mensagem" widgetVar="mensagemDialog" modal="true" width="400" appendToBody="true">  
			        
		            <h:panelGrid id="pgMensagem" columns="2" columnClasses="coluna25_2, coluna75_2" style="width:100%; vertical-align: top">
		                    
		                <h:outputText value="Data:" />  
		                <h:outputText value="#{mensagemFaces.mensagemSelecionada.data}" />
		                  
		                <h:outputText value="Remetente:" />
		                <h:outputText value="#{mensagemFaces.mensagemSelecionada.remetente.nome}" />
		                  
		                <h:outputText value="Mensagem:" />
		                <h:outputText value="#{mensagemFaces.mensagemSelecionada.texto}" style="text-align: lef;"/>
		                  
		            </h:panelGrid> 
		            
		            <h:panelGrid columns="1" style="text-align: center">
		            	<p:commandButton value="Responder" onclick="mensagemDialog.show();" >
		            		
		            	</p:commandButton>
		            </h:panelGrid>
			              
			    </p:dialog>  
			  
			</h:form>
			
		</p:tab>
		
	</p:tabView>
  	
</ui:composition>