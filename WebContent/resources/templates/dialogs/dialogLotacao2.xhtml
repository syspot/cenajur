<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:component xmlns="http://www.w3.org/1999/xhtml"
              xmlns:ui="http://java.sun.com/jsf/facelets"
              xmlns:h="http://java.sun.com/jsf/html"
              xmlns:p="http://primefaces.org/ui"
              xmlns:f="http://java.sun.com/jsf/core">

	<ui:param name="mbeanPesquisa" value="${lotacaoPesquisaFaces}" />

	<h:form rendered="#{autenticacaoFaces.mostrarDialogLotacao}">
		
		<p:dialog id="dialogLotacao2" widgetVar="dlgLotacao2" header="Pesquisa de Lotações" width="600" height="400" modal="true">
	  
	  		<h:panelGrid id="pgCampos" columns="2" columnClasses="coluna60, coluna40" style="width:90%">
	  		
				<p:outputLabel for="dlgDescricaoLotacao" value="Descrição" />
				<p:outputLabel for="dlgBairroLotacao" value="Bairro" />
				
				<p:inputText id="dlgDescricaoLotacao" value="#{mbeanPesquisa.model.descricao}" maxlength="50" styleClass="coluna90"/>
				<p:inputText id="dlgBairroLotacao" value="#{mbeanPesquisa.model.bairro}" maxlength="50" styleClass="coluna90"/>
	  			
	  			<p:outputLabel for="dlgEstadoLotacao" value="Estado" />
				<p:outputLabel for="dlgCidadeLotacao" value="Cidade" />
				
				<p:selectOneMenu id="dlgEstadoLotacao" value="#{mbeanPesquisa.model.cidade.estado.id}" style="width:92%">
	  				<f:selectItem itemLabel="Não Selecionado" itemValue="" />
	  				<f:selectItems value="#{mbeanPesquisa.estados}"/>
	  				<p:ajax listener="#{mbeanPesquisa.atualizarComboCidades}" update="pgCampos" global="false"/>
	  			</p:selectOneMenu>
				<p:selectOneMenu id="dlgCidadeLotacao" value="#{mbeanPesquisa.model.cidade.id}" style="width:90%" disabled="#{mbeanPesquisa.model.cidade.estado.id == null}">
	  				<f:selectItem itemLabel="Não Selecionado" itemValue="" />
	  				<f:selectItems value="#{mbeanPesquisa.cidades}"/>
	  			</p:selectOneMenu>
				
				<p:commandButton value="Pesquisar" icon="pesquisar" action="#{mbeanPesquisa.find}" update="gridPesquisa" style="width: 140px; margin-left: 5px;"/>
				
			</h:panelGrid>
			
			<br/>
			
			<p:dataTable id="gridPesquisa" emptyMessage="Nenhuma lotação encontrada" paginator="true"
								paginatorAlwaysVisible="false" rows="5" value="#{mbeanPesquisa.grid}" var="lotacao">
			
				<p:column headerText="Descrição">
					<h:outputText value="#{lotacao.descricao}" />
				</p:column>
			
				<p:column headerText="Cidade">
					<h:outputText value="#{lotacao.cidade.descricao}" />
				</p:column>
				
				<p:column headerText="Adicionar" styleClass="coluna10" style="text-align:center;">
					<p:commandLink action="#{clienteFaces.addLotacaoPesquisa}" process="@this" oncomplete="dlgLotacao2.hide()" global="false">
						<h:graphicImage value="../resources/images/plus16.png" style="border: 0px" />
						<f:setPropertyActionListener target="#{clienteFaces.lotacaoSelecionada}" value="#{lotacao}" />
					</p:commandLink>
				</p:column>
			
			</p:dataTable>
	  
		</p:dialog>
	
	</h:form>

</ui:component>
